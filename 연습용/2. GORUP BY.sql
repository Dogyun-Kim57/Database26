USE pracitce_db
SELECT * FROM gmembers;


/* 
-----------------------------------------------------------
              < GROUP BY에 대한 개념 >
-----------------------------------------------------------
SELECT는 기본적으로 행(row) 단위로 보여주는 도구이다.
예를들어 gmembers를 그냥 조회한다면...
select city, age from gmembers;

결과는 도시, 나이 처럼 개별 데이터만 보여준다.
그러나 통상적인 상황에서는 보통 이런 질문을 더 많이 던지게 된다.

'도시 별로 사람은 몇 명임?'
'성별 평균 나이는?'
'도시별 최고 나이는?'
'강의별 수강 인원은?' 등등..

이건 '개별 행'을 보는게 아니라 **요약(집계)**가 더 필요하다.
GROUP BY는 행들을 기준별로 묶어서 요약 계산을 할 수 있게 만들어 주는 문법이다.
-----------------------------------------------------------
GROUP BY 없으면 뭐가 안 되나? (직관 예시)
-----------------------------------------------------------
도시별 인원 수를 GROUP BY 없이 하려고 하면 ?
-----------------------------------------------------------
SELECT city, COUNT(*)
FROM members;

이렇게 쓰면 city가 여러 개 섞여 있는데 COUNT(*)는 전체를 하나로 센다.
DB 입장에서는 “도시가 여러 개인데 city를 뭘로 보여주라는 거지?”가 돼서 에러가 나거나(설정에 따라) 의미 없는 결과가 나오게 된다. */
-- -----------------------------------------------------------
/*
-----------------------------------------------------------
그러나! GROUP BY가 있으면? 
-----------------------------------------------------------
select city, count(*) as 거주인원
from gmembers
group by city;

/* 해당 결과값은 서울 3명, 부산 2명, 대구 1명 이렇게 출력이 되는데..
이는 city가 같은 행들을 한 덩어리로 묶고
그 덩어리마다 count(*)를 계산하여
도시별로 결과를 한 줄씩 출력해서 보여주는것이다.
-----------------------------------------------------------
즉, GROUP BY는 '엑셀 피벗 테이블' 같은 역할이다.
-----------------------------------------------------------
엑셀에서
'도시'로 묶고
'인원 수'를 세고
'평균 나이'를 구하는
그 피벗/집계 작업을 SQL로 하는 게 GROUP BY이다.
----------------------------------------------------------- */

-- --------------------------------------------------------
-- group by 예제 --
-- --------------------------------------------------------
-- < 갯수 세기 > -- (COUNT)
-- --------------------------------------------------------
# 질문 : 여기 회원들의 고향은 각각 도시별로 몇명입니까?

select city, count(*) as cnt
from gmembers
group by city;

# 답 : 서울 3명 , 부산 2명 , 대구 1명
-- --------------------------------------------------------
-- < 합계에 대한 평균 구하기 > -- (SUM/AVG)
-- --------------------------------------------------------
# 질문 : 그럼 그 지역 출신 회원의 나이 평균은 어떻게 됩니까?

select city, AVG(age) AS avg_age
from gmembers
group by city;

# 해당 결과값은 서울 31.6667 , 부산 33.5000 , 대구 28.0000
-- --------------------------------------------------------
-- < 최대값 및 최소값 > -- (MAX/MIN)
-- --------------------------------------------------------
# 예제 : 회원들 중 성별로 가장 많은 나이와 적은 나이를 구분하세요.
select gender, max(age) as max_age, min(age) as min_age
from gmembers
group by gender;

# 해당 결과값은 (남성) 최고령자 41세 , 최연소 25세   (여성) 최고령자 32세, 최연소 28세
-- --------------------------------------------------------
-- < 조건 걸고 요약 > -- (WHERE + GROUP BY)
-- --------------------------------------------------------
# 예제 : 30세 이상의 회원들은 어디 출신이며, 각 출신 도시마다 몇명입니까?

select city, count(*) as cnt
from gmembers
where age >= 30
group by city;

# 해당 결과값은 30세 이상 회원은 부산 출신 2명 , 서울 출신 1명!

# ----------------------------------------------------------------
/* 
----------------------------------------------------------------
			      < 추가적으로 알아야 할 것! >
----------------------------------------------------------------
여기서 가장 중요한 규칙은!
group by를 사용하게 되면...
select에 있는 컬럼은
group by에 포함되거나, 집계함수인 (count/avg) 등으로 감싸져야한다.

결론으로 group by를 써야 하는 이유는
데이터를 '정보'로 바꿀 수 있기 때문이다!

그냥 select가 '회원 목록'이라면...
group by는 '도시별 통계' 및 '성별 통계' 더 나아가 '강의별 집계' 같은 요약/분석 결과를 도출해 낼 수 있다. */






















